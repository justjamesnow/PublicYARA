rule cve_2018_20250_path_traversal_1 : Windows CVE Filetype {
	meta:
		author = "James E.C, Emerging Threats - Proofpoint"
		twitter = "@EcOzurie"
		mastodon = "https://infosec.exchange/@ozurie"
		description = "Rar/ACE stuff"
		reference = "https://isc.sans.edu/diary/.rar+Files+and+ACE+Exploit+CVE-2018-20250/24864"
		reference = "https://www.exploit-db.com/exploits/46552"
		date = "23-04-2019"
		id = "unassigned"
	strings:
		$ace = { 2a 2a 41 43 45 2a 2a }
		$exp1 = /\x00(\S\:\\){2,}/
		$exp2 = { 00 ?? 3a 5c ?? 3a ?? 3a } // c:\c:c: (also covers the c:\c:c:..\ variant)
		$exp3 = /\x00\S\:\\\\\\([0-9]{1,3}\.){3}[0-9]{1,3}/ // covering SMB variant with IP address (loose IP regex, performance)
		$exp4 = /\x00\S\:\\\\\\([a-z0-9\-]{1,30}\.){1,8}[a-z]{1,8}/i // covering SMB variant with loose domain structure
	condition:
		$ace at 7 and 1 of ($exp*)
}
