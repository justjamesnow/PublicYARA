rule apt_bisonal : APT Windows Bisonal {
	meta:
		author = "James E.C, Emerging Threats - Proofpoint"
		twitter = "@EcOzurie"
		mastodon = "https://infosec.exchange/@ozurie"
		description = "Bisonal malware used against Russia and South Korea in 2018."
		date = "31-07-2018"
		hashes = "CC71620DE7216B186DA2C9BA06703613"
		id = "10000"
	strings:
		$u1 = { 61 6b 73 70 62 75 2e 74 78 74 } // akspbu.txt (URI string)
		$u2 = { 30 34 32 35 67 6f 64 } // 0425god (CnC Beacon)
		$u3 = { 51 73 7a 64 65 7a } // Qszdez (Export)
		$u4 = { 6b 73 38 64 } // ks8d (URI string)
		$u5_rc4_seq = { 8a 1c 38 32 da 88 1c 38 40 3b c5 }
		$u6_rc4_key = { 78 56 34 12 }
		$u7 = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322" ascii fullword // Hardcoded UA missing closing parenthesis
	condition:
		uint16(0) == 0x5a4d and filesize < 200KB and (3 of ($u*))
}
