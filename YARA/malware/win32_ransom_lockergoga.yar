rule win32_crimeransom_LockerGoga : Crime Ransom Win32 {
   meta: 
		author = "James E.C, Emerging Threats - Proofpoint"
		twitter = "@EcOzurie"
		mastodon = "https://infosec.exchange/@ozurie"
		description = "Detects LockerGoga's initial dropped binary before multiple rounds of proc creation."
		hashes = "c97d9bbc80b573bdeeda3812f4d00e5183493dd0d5805e2508728f65977dda15"
		date = "19-03-2019"
		category = "malware"
		malfamily = "LockerGoga"
   strings:
		$s1 = "=.locked" wide
		$s2 = "README_LOCKED.txt" ascii
		$s3 = "c:/.log" ascii
		$s4 = /Service\s*[a-z]{5,15}/ wide
		$s5 = "There was a significant flaw in the security system of your company" ascii
		$s6 = "was exploited by serious people and not some rookies." ascii

		$eml1 = "wyattpettigrew8922555@mail.com" // Hydro incident
		$eml2 = "SuzuMcpherson@protonmail.com" // Unknown, present in memory
		$eml3 = "DharmaParrack@protonmail.com" // Hydro incident
   condition:
		(4 of ($s*)) or (1 of ($eml*) and 2 of ($s*))
}
