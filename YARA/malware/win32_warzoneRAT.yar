rule win32_warzoneRAT : Windows RAT {
	meta:
		author = "James E.C, Emerging Threats - Proofpoint"
		twitter = "@EcOzurie"
		mastodon = "https://infosec.exchange/@ozurie"
		description = "New Warzone RAT hunting."
		hashes = "d95eaac6b838437ef502ba190da2fa82" // Warzone RAT.exe
		date = "31-10-2018"
		category = "experimental"
		malfamily = "WarzoneRAT"
	strings:
		$s1 = "WARZONE RAT" ascii
		$s2 = "WARZONE RAT" wide

		$xor_1 = { 80 F1 A3 80 F2 54 [1-30] 80 F2 75 [1-30] 80 F1 E7 80 F2 44 }
		$xor_2 = { 80 F1 ?? 80 F2 ?? 88 4C ?? 04 0F B6 48 ?? 88 54 ?? 05 0F B6 50 ?? F6 D1 }
	condition:
		(uint16be(0) == 0x4d5a) and (1 of ($s*) and ($xor_1 or $xor_2))
}
